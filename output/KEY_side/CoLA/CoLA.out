n31
0: n31
0: /home/kangchen/Rehrearsal_TransferLearning/python_script/BERT-GLUE
04/11/2022 17:47:51 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 4distributed training: False, 16-bits training: False
04/11/2022 17:47:51 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=4,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=None,
evaluation_strategy=IntervalStrategy.NO,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=output/CoLA/BERT/runs/Apr11_17-47-51_n31,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=40.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=output/CoLA/BERT/,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=output/CoLA/BERT/,
save_on_each_node=False,
save_steps=500,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/11/2022 17:47:52 - INFO - datasets.info - Loading Dataset Infos from /home/kangchen/.cache/huggingface/modules/datasets_modules/datasets/glue/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 17:47:52 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/11/2022 17:47:52 - INFO - datasets.info - Loading Dataset info from /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 17:47:52 - WARNING - datasets.builder - Reusing dataset glue (/home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad)
04/11/2022 17:47:52 - INFO - datasets.info - Loading Dataset info from /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 17:48:05 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-7693477a0b51ad3c.arrow
04/11/2022 17:48:05 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-323b6a71d9e399c8.arrow
04/11/2022 17:48:05 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-90cb09b7429e1037.arrow
04/11/2022 17:48:05 - INFO - __main__ - Sample 1824 of the training set: {'sentence': 'I acknowledged that my father, he was tight as an owl.', 'label': 0, 'idx': 1824, 'input_ids': [101, 146, 8646, 1115, 1139, 1401, 117, 1119, 1108, 3600, 1112, 1126, 19976, 119, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 17:48:05 - INFO - __main__ - Sample 409 of the training set: {'sentence': 'For him to do that would be a mistake.', 'label': 1, 'idx': 409, 'input_ids': [101, 1370, 1140, 1106, 1202, 1115, 1156, 1129, 170, 6223, 119, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 17:48:05 - INFO - __main__ - Sample 4506 of the training set: {'sentence': 'Mary sang a song, but Lee never did.', 'label': 1, 'idx': 4506, 'input_ids': [101, 2090, 6407, 170, 1461, 117, 1133, 2499, 1309, 1225, 119, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
{'loss': 0.5111, 'learning_rate': 1.9626865671641793e-05, 'epoch': 0.75}
04/11/2022 17:49:43 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.44567346572875977, 'eval_matthews_correlation': 0.5359802487630552, 'eval_runtime': 3.5658, 'eval_samples_per_second': 292.505, 'eval_steps_per_second': 4.768, 'epoch': 1.0}
{'loss': 0.3166, 'learning_rate': 1.9253731343283585e-05, 'epoch': 1.49}
04/11/2022 17:51:15 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.4085988402366638, 'eval_matthews_correlation': 0.6340992349486394, 'eval_runtime': 3.5703, 'eval_samples_per_second': 292.133, 'eval_steps_per_second': 4.762, 'epoch': 2.0}
{'loss': 0.2494, 'learning_rate': 1.8880597014925376e-05, 'epoch': 2.24}
{'loss': 0.1633, 'learning_rate': 1.8507462686567165e-05, 'epoch': 2.99}
04/11/2022 17:52:49 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.4485543668270111, 'eval_matthews_correlation': 0.6440774707016963, 'eval_runtime': 3.6436, 'eval_samples_per_second': 286.253, 'eval_steps_per_second': 4.666, 'epoch': 3.0}
{'loss': 0.1034, 'learning_rate': 1.8134328358208956e-05, 'epoch': 3.73}
04/11/2022 17:54:22 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.5350152254104614, 'eval_matthews_correlation': 0.6431079373028232, 'eval_runtime': 3.577, 'eval_samples_per_second': 291.588, 'eval_steps_per_second': 4.753, 'epoch': 4.0}
{'loss': 0.0933, 'learning_rate': 1.7761194029850748e-05, 'epoch': 4.48}
04/11/2022 17:55:55 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.6866900324821472, 'eval_matthews_correlation': 0.5981333967857257, 'eval_runtime': 3.5619, 'eval_samples_per_second': 292.82, 'eval_steps_per_second': 4.773, 'epoch': 5.0}
{'loss': 0.0829, 'learning_rate': 1.738805970149254e-05, 'epoch': 5.22}
{'loss': 0.077, 'learning_rate': 1.701492537313433e-05, 'epoch': 5.97}
04/11/2022 17:57:29 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.6272087097167969, 'eval_matthews_correlation': 0.6358868443209523, 'eval_runtime': 3.6264, 'eval_samples_per_second': 287.611, 'eval_steps_per_second': 4.688, 'epoch': 6.0}
{'loss': 0.0579, 'learning_rate': 1.6641791044776122e-05, 'epoch': 6.72}
04/11/2022 17:59:02 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7873929738998413, 'eval_matthews_correlation': 0.6336264552651618, 'eval_runtime': 3.559, 'eval_samples_per_second': 293.063, 'eval_steps_per_second': 4.777, 'epoch': 7.0}
{'loss': 0.0462, 'learning_rate': 1.626865671641791e-05, 'epoch': 7.46}
04/11/2022 18:00:35 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8646031022071838, 'eval_matthews_correlation': 0.6115083173955205, 'eval_runtime': 3.5902, 'eval_samples_per_second': 290.514, 'eval_steps_per_second': 4.735, 'epoch': 8.0}
{'loss': 0.0346, 'learning_rate': 1.5895522388059702e-05, 'epoch': 8.21}
{'loss': 0.0449, 'learning_rate': 1.5522388059701494e-05, 'epoch': 8.96}
04/11/2022 18:02:08 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8459088206291199, 'eval_matthews_correlation': 0.5957258748412207, 'eval_runtime': 3.6452, 'eval_samples_per_second': 286.127, 'eval_steps_per_second': 4.664, 'epoch': 9.0}
{'loss': 0.026, 'learning_rate': 1.5149253731343285e-05, 'epoch': 9.7}
04/11/2022 18:03:41 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.0161828994750977, 'eval_matthews_correlation': 0.5839877966506434, 'eval_runtime': 3.5705, 'eval_samples_per_second': 292.113, 'eval_steps_per_second': 4.761, 'epoch': 10.0}
{'loss': 0.032, 'learning_rate': 1.4776119402985077e-05, 'epoch': 10.45}
04/11/2022 18:05:15 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.0803468227386475, 'eval_matthews_correlation': 0.6231873551222902, 'eval_runtime': 3.5794, 'eval_samples_per_second': 291.392, 'eval_steps_per_second': 4.749, 'epoch': 11.0}
{'loss': 0.0231, 'learning_rate': 1.4402985074626867e-05, 'epoch': 11.19}
{'loss': 0.0267, 'learning_rate': 1.4029850746268658e-05, 'epoch': 11.94}
04/11/2022 18:06:48 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1620820760726929, 'eval_matthews_correlation': 0.6306644810568987, 'eval_runtime': 3.6594, 'eval_samples_per_second': 285.016, 'eval_steps_per_second': 4.646, 'epoch': 12.0}
{'loss': 0.0197, 'learning_rate': 1.365671641791045e-05, 'epoch': 12.69}
04/11/2022 18:08:22 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1334431171417236, 'eval_matthews_correlation': 0.6041016933970672, 'eval_runtime': 3.5777, 'eval_samples_per_second': 291.526, 'eval_steps_per_second': 4.752, 'epoch': 13.0}
{'loss': 0.0244, 'learning_rate': 1.328358208955224e-05, 'epoch': 13.43}
04/11/2022 18:09:55 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9329948425292969, 'eval_matthews_correlation': 0.6157364530398333, 'eval_runtime': 3.6098, 'eval_samples_per_second': 288.935, 'eval_steps_per_second': 4.709, 'epoch': 14.0}
{'loss': 0.0211, 'learning_rate': 1.2910447761194032e-05, 'epoch': 14.18}
{'loss': 0.0147, 'learning_rate': 1.2537313432835823e-05, 'epoch': 14.93}
04/11/2022 18:11:29 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1540697813034058, 'eval_matthews_correlation': 0.6211254337621169, 'eval_runtime': 3.5639, 'eval_samples_per_second': 292.657, 'eval_steps_per_second': 4.77, 'epoch': 15.0}
{'loss': 0.0154, 'learning_rate': 1.2164179104477613e-05, 'epoch': 15.67}
04/11/2022 18:13:02 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1042165756225586, 'eval_matthews_correlation': 0.6307674593953669, 'eval_runtime': 3.5723, 'eval_samples_per_second': 291.969, 'eval_steps_per_second': 4.759, 'epoch': 16.0}
{'loss': 0.0172, 'learning_rate': 1.1791044776119405e-05, 'epoch': 16.42}
04/11/2022 18:14:36 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.108868956565857, 'eval_matthews_correlation': 0.620765149261144, 'eval_runtime': 3.6172, 'eval_samples_per_second': 288.346, 'eval_steps_per_second': 4.7, 'epoch': 17.0}
{'loss': 0.0091, 'learning_rate': 1.1417910447761196e-05, 'epoch': 17.16}
{'loss': 0.0066, 'learning_rate': 1.1044776119402986e-05, 'epoch': 17.91}
04/11/2022 18:16:10 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3326365947723389, 'eval_matthews_correlation': 0.6131862438295606, 'eval_runtime': 3.6543, 'eval_samples_per_second': 285.415, 'eval_steps_per_second': 4.652, 'epoch': 18.0}
{'loss': 0.008, 'learning_rate': 1.0671641791044778e-05, 'epoch': 18.66}
04/11/2022 18:17:44 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.225833535194397, 'eval_matthews_correlation': 0.6257597716930143, 'eval_runtime': 3.576, 'eval_samples_per_second': 291.666, 'eval_steps_per_second': 4.754, 'epoch': 19.0}
{'loss': 0.0108, 'learning_rate': 1.029850746268657e-05, 'epoch': 19.4}
04/11/2022 18:19:18 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3136911392211914, 'eval_matthews_correlation': 0.605784652517054, 'eval_runtime': 3.5787, 'eval_samples_per_second': 291.449, 'eval_steps_per_second': 4.75, 'epoch': 20.0}
{'loss': 0.0092, 'learning_rate': 9.925373134328359e-06, 'epoch': 20.15}
{'loss': 0.0081, 'learning_rate': 9.552238805970149e-06, 'epoch': 20.9}
04/11/2022 18:20:51 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.331394076347351, 'eval_matthews_correlation': 0.6058664045311455, 'eval_runtime': 3.6446, 'eval_samples_per_second': 286.179, 'eval_steps_per_second': 4.664, 'epoch': 21.0}
{'loss': 0.0079, 'learning_rate': 9.17910447761194e-06, 'epoch': 21.64}
04/11/2022 18:22:25 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1702804565429688, 'eval_matthews_correlation': 0.6319911054099576, 'eval_runtime': 3.6069, 'eval_samples_per_second': 289.166, 'eval_steps_per_second': 4.713, 'epoch': 22.0}
{'loss': 0.0123, 'learning_rate': 8.805970149253732e-06, 'epoch': 22.39}
04/11/2022 18:23:59 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3775779008865356, 'eval_matthews_correlation': 0.623185623360598, 'eval_runtime': 3.5642, 'eval_samples_per_second': 292.631, 'eval_steps_per_second': 4.77, 'epoch': 23.0}
{'loss': 0.0048, 'learning_rate': 8.432835820895524e-06, 'epoch': 23.13}
{'loss': 0.0069, 'learning_rate': 8.059701492537314e-06, 'epoch': 23.88}
04/11/2022 18:25:32 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3253718614578247, 'eval_matthews_correlation': 0.6281549838358158, 'eval_runtime': 3.5462, 'eval_samples_per_second': 294.116, 'eval_steps_per_second': 4.794, 'epoch': 24.0}
{'loss': 0.0068, 'learning_rate': 7.686567164179105e-06, 'epoch': 24.63}
04/11/2022 18:27:05 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.5224992036819458, 'eval_matthews_correlation': 0.6010821430476319, 'eval_runtime': 3.6767, 'eval_samples_per_second': 283.675, 'eval_steps_per_second': 4.624, 'epoch': 25.0}
{'loss': 0.005, 'learning_rate': 7.313432835820896e-06, 'epoch': 25.37}
04/11/2022 18:28:39 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3619157075881958, 'eval_matthews_correlation': 0.6206837048829764, 'eval_runtime': 3.5899, 'eval_samples_per_second': 290.534, 'eval_steps_per_second': 4.735, 'epoch': 26.0}
{'loss': 0.0073, 'learning_rate': 6.9402985074626876e-06, 'epoch': 26.12}
{'loss': 0.0055, 'learning_rate': 6.567164179104478e-06, 'epoch': 26.87}
04/11/2022 18:30:12 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.2995758056640625, 'eval_matthews_correlation': 0.6381410668671454, 'eval_runtime': 3.5821, 'eval_samples_per_second': 291.173, 'eval_steps_per_second': 4.746, 'epoch': 27.0}
{'loss': 0.0065, 'learning_rate': 6.194029850746269e-06, 'epoch': 27.61}
04/11/2022 18:31:46 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.318536400794983, 'eval_matthews_correlation': 0.633176717769807, 'eval_runtime': 3.5525, 'eval_samples_per_second': 293.592, 'eval_steps_per_second': 4.785, 'epoch': 28.0}
{'loss': 0.0032, 'learning_rate': 5.820895522388061e-06, 'epoch': 28.36}
04/11/2022 18:33:19 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.4267170429229736, 'eval_matthews_correlation': 0.6156933167960152, 'eval_runtime': 3.6511, 'eval_samples_per_second': 285.671, 'eval_steps_per_second': 4.656, 'epoch': 29.0}
{'loss': 0.0032, 'learning_rate': 5.447761194029851e-06, 'epoch': 29.1}
{'loss': 0.0065, 'learning_rate': 5.074626865671642e-06, 'epoch': 29.85}
04/11/2022 18:34:53 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.4011064767837524, 'eval_matthews_correlation': 0.6281691768918801, 'eval_runtime': 3.5482, 'eval_samples_per_second': 293.955, 'eval_steps_per_second': 4.791, 'epoch': 30.0}
{'loss': 0.002, 'learning_rate': 4.701492537313434e-06, 'epoch': 30.6}
04/11/2022 18:36:26 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3857511281967163, 'eval_matthews_correlation': 0.6431581256935667, 'eval_runtime': 3.5773, 'eval_samples_per_second': 291.559, 'eval_steps_per_second': 4.752, 'epoch': 31.0}
{'loss': 0.0027, 'learning_rate': 4.3283582089552236e-06, 'epoch': 31.34}
04/11/2022 18:37:59 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.4860342741012573, 'eval_matthews_correlation': 0.6207242502214079, 'eval_runtime': 3.6227, 'eval_samples_per_second': 287.909, 'eval_steps_per_second': 4.693, 'epoch': 32.0}
{'loss': 0.0047, 'learning_rate': 3.955223880597015e-06, 'epoch': 32.09}
{'loss': 0.0073, 'learning_rate': 3.582089552238806e-06, 'epoch': 32.84}
04/11/2022 18:39:32 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3258455991744995, 'eval_matthews_correlation': 0.6308143863677894, 'eval_runtime': 3.553, 'eval_samples_per_second': 293.558, 'eval_steps_per_second': 4.785, 'epoch': 33.0}
{'loss': 0.0032, 'learning_rate': 3.208955223880597e-06, 'epoch': 33.58}
04/11/2022 18:41:06 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3658522367477417, 'eval_matthews_correlation': 0.6307435718195655, 'eval_runtime': 3.5883, 'eval_samples_per_second': 290.669, 'eval_steps_per_second': 4.738, 'epoch': 34.0}
{'loss': 0.0034, 'learning_rate': 2.835820895522388e-06, 'epoch': 34.33}
04/11/2022 18:42:39 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.4190738201141357, 'eval_matthews_correlation': 0.6281549838358158, 'eval_runtime': 3.6247, 'eval_samples_per_second': 287.746, 'eval_steps_per_second': 4.69, 'epoch': 35.0}
{'loss': 0.0022, 'learning_rate': 2.4626865671641794e-06, 'epoch': 35.07}
{'loss': 0.0017, 'learning_rate': 2.08955223880597e-06, 'epoch': 35.82}
04/11/2022 18:44:12 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.4501086473464966, 'eval_matthews_correlation': 0.623185623360598, 'eval_runtime': 3.5523, 'eval_samples_per_second': 293.616, 'eval_steps_per_second': 4.786, 'epoch': 36.0}
{'loss': 0.0047, 'learning_rate': 1.7164179104477613e-06, 'epoch': 36.57}
04/11/2022 18:45:46 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.4454123973846436, 'eval_matthews_correlation': 0.6256740929699375, 'eval_runtime': 3.5484, 'eval_samples_per_second': 293.938, 'eval_steps_per_second': 4.791, 'epoch': 37.0}
{'loss': 0.0034, 'learning_rate': 1.3432835820895524e-06, 'epoch': 37.31}
04/11/2022 18:47:19 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.407303810119629, 'eval_matthews_correlation': 0.6380902412628672, 'eval_runtime': 3.659, 'eval_samples_per_second': 285.05, 'eval_steps_per_second': 4.646, 'epoch': 38.0}
{'loss': 0.0072, 'learning_rate': 9.701492537313434e-07, 'epoch': 38.06}
{'loss': 0.0053, 'learning_rate': 5.970149253731343e-07, 'epoch': 38.81}
04/11/2022 18:48:53 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.4298359155654907, 'eval_matthews_correlation': 0.6282273595071006, 'eval_runtime': 3.6312, 'eval_samples_per_second': 287.229, 'eval_steps_per_second': 4.682, 'epoch': 39.0}
{'loss': 0.0019, 'learning_rate': 2.2388059701492537e-07, 'epoch': 39.55}
04/11/2022 18:50:26 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.4308604001998901, 'eval_matthews_correlation': 0.6282273595071006, 'eval_runtime': 3.5716, 'eval_samples_per_second': 292.025, 'eval_steps_per_second': 4.76, 'epoch': 40.0}
{'train_runtime': 3749.3698, 'train_samples_per_second': 91.226, 'train_steps_per_second': 1.43, 'train_loss': 0.040680430245710844, 'epoch': 40.0}
***** train metrics *****
  epoch                    =       40.0
  train_loss               =     0.0407
  train_runtime            = 1:02:29.36
  train_samples            =       8551
  train_samples_per_second =     91.226
  train_steps_per_second   =       1.43
04/11/2022 18:50:45 - INFO - __main__ - *** Evaluate ***
04/11/2022 18:50:49 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
***** eval metrics *****
  epoch                     =       40.0
  eval_loss                 =     0.4086
  eval_matthews_correlation =     0.6341
  eval_runtime              = 0:00:03.74
  eval_samples              =       1043
  eval_samples_per_second   =    278.323
  eval_steps_per_second     =      4.536
04/11/2022 18:50:54 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 4distributed training: False, 16-bits training: False
04/11/2022 18:50:54 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=4,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=None,
evaluation_strategy=IntervalStrategy.NO,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=output/CoLA/ALBERTRT/runs/Apr11_18-50-54_n31,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=40.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=output/CoLA/ALBERTRT/,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=output/CoLA/ALBERTRT/,
save_on_each_node=False,
save_steps=500,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/11/2022 18:50:55 - INFO - datasets.info - Loading Dataset Infos from /home/kangchen/.cache/huggingface/modules/datasets_modules/datasets/glue/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 18:50:55 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/11/2022 18:50:55 - INFO - datasets.info - Loading Dataset info from /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 18:50:55 - WARNING - datasets.builder - Reusing dataset glue (/home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad)
04/11/2022 18:50:55 - INFO - datasets.info - Loading Dataset info from /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 18:51:00 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-aa3fae33aaa1f887.arrow
04/11/2022 18:51:00 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-94349187c1f13932.arrow
04/11/2022 18:51:00 - INFO - datasets.arrow_dataset - Caching processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-d058bb073726e11b.arrow
04/11/2022 18:51:00 - INFO - __main__ - Sample 1824 of the training set: {'sentence': 'I acknowledged that my father, he was tight as an owl.', 'label': 0, 'idx': 1824, 'input_ids': [2, 31, 8933, 30, 51, 321, 15, 24, 23, 2618, 28, 40, 11170, 9, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 18:51:00 - INFO - __main__ - Sample 409 of the training set: {'sentence': 'For him to do that would be a mistake.', 'label': 1, 'idx': 409, 'input_ids': [2, 26, 61, 20, 107, 30, 83, 44, 21, 5643, 9, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 18:51:00 - INFO - __main__ - Sample 4506 of the training set: {'sentence': 'Mary sang a song, but Lee never did.', 'label': 1, 'idx': 4506, 'input_ids': [2, 1044, 3811, 21, 338, 15, 47, 1358, 243, 144, 9, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 18:51:18 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 4distributed training: False, 16-bits training: False
04/11/2022 18:51:18 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=4,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=None,
evaluation_strategy=IntervalStrategy.NO,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=output/CoLA/RoBERTa/runs/Apr11_18-51-18_n31,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=40.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=output/CoLA/RoBERTa/,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=output/CoLA/RoBERTa/,
save_on_each_node=False,
save_steps=500,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/11/2022 18:51:19 - INFO - datasets.info - Loading Dataset Infos from /home/kangchen/.cache/huggingface/modules/datasets_modules/datasets/glue/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 18:51:19 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/11/2022 18:51:19 - INFO - datasets.info - Loading Dataset info from /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 18:51:19 - WARNING - datasets.builder - Reusing dataset glue (/home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad)
04/11/2022 18:51:19 - INFO - datasets.info - Loading Dataset info from /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 18:51:31 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-315b9297a59e007d.arrow
04/11/2022 18:51:31 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-f6c28b5989ac47f1.arrow
04/11/2022 18:51:31 - INFO - datasets.arrow_dataset - Caching processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-5ddb6ced6ce92093.arrow
04/11/2022 18:51:31 - INFO - __main__ - Sample 1824 of the training set: {'sentence': 'I acknowledged that my father, he was tight as an owl.', 'label': 0, 'idx': 1824, 'input_ids': [0, 100, 5055, 14, 127, 1150, 6, 37, 21, 3229, 25, 41, 37323, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 18:51:31 - INFO - __main__ - Sample 409 of the training set: {'sentence': 'For him to do that would be a mistake.', 'label': 1, 'idx': 409, 'input_ids': [0, 2709, 123, 7, 109, 14, 74, 28, 10, 5021, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 18:51:31 - INFO - __main__ - Sample 4506 of the training set: {'sentence': 'Mary sang a song, but Lee never did.', 'label': 1, 'idx': 4506, 'input_ids': [0, 24877, 11944, 10, 2214, 6, 53, 2094, 393, 222, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
{'loss': 0.5978, 'learning_rate': 1.9626865671641793e-05, 'epoch': 0.75}
04/11/2022 18:53:06 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.541348397731781, 'eval_matthews_correlation': 0.5316737133065886, 'eval_runtime': 3.3911, 'eval_samples_per_second': 307.568, 'eval_steps_per_second': 5.013, 'epoch': 1.0}
{'loss': 0.418, 'learning_rate': 1.9253731343283585e-05, 'epoch': 1.49}
04/11/2022 18:54:40 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.4070320427417755, 'eval_matthews_correlation': 0.5701789905913004, 'eval_runtime': 3.3836, 'eval_samples_per_second': 308.252, 'eval_steps_per_second': 5.024, 'epoch': 2.0}
{'loss': 0.3603, 'learning_rate': 1.8880597014925376e-05, 'epoch': 2.24}
{'loss': 0.2765, 'learning_rate': 1.8507462686567165e-05, 'epoch': 2.99}
04/11/2022 18:56:14 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.40474212169647217, 'eval_matthews_correlation': 0.6331219341866674, 'eval_runtime': 3.4608, 'eval_samples_per_second': 301.376, 'eval_steps_per_second': 4.912, 'epoch': 3.0}
{'loss': 0.2072, 'learning_rate': 1.8134328358208956e-05, 'epoch': 3.73}
04/11/2022 18:57:49 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.3984921872615814, 'eval_matthews_correlation': 0.6233293453039225, 'eval_runtime': 3.4365, 'eval_samples_per_second': 303.504, 'eval_steps_per_second': 4.947, 'epoch': 4.0}
{'loss': 0.1696, 'learning_rate': 1.7761194029850748e-05, 'epoch': 4.48}
04/11/2022 18:59:23 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.4690905213356018, 'eval_matthews_correlation': 0.6433364564823282, 'eval_runtime': 3.3938, 'eval_samples_per_second': 307.324, 'eval_steps_per_second': 5.009, 'epoch': 5.0}
{'loss': 0.1373, 'learning_rate': 1.738805970149254e-05, 'epoch': 5.22}
{'loss': 0.1225, 'learning_rate': 1.701492537313433e-05, 'epoch': 5.97}
04/11/2022 19:00:56 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.524791419506073, 'eval_matthews_correlation': 0.6137241978691702, 'eval_runtime': 3.4097, 'eval_samples_per_second': 305.888, 'eval_steps_per_second': 4.986, 'epoch': 6.0}
{'loss': 0.0946, 'learning_rate': 1.6641791044776122e-05, 'epoch': 6.72}
04/11/2022 19:02:31 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.5892418026924133, 'eval_matthews_correlation': 0.6520807506207891, 'eval_runtime': 3.3988, 'eval_samples_per_second': 306.87, 'eval_steps_per_second': 5.002, 'epoch': 7.0}
{'loss': 0.0916, 'learning_rate': 1.626865671641791e-05, 'epoch': 7.46}
04/11/2022 19:04:05 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8769382834434509, 'eval_matthews_correlation': 0.6181942347761422, 'eval_runtime': 3.5161, 'eval_samples_per_second': 296.634, 'eval_steps_per_second': 4.835, 'epoch': 8.0}
{'loss': 0.0854, 'learning_rate': 1.5895522388059702e-05, 'epoch': 8.21}
{'loss': 0.0742, 'learning_rate': 1.5522388059701494e-05, 'epoch': 8.96}
04/11/2022 19:05:39 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7724927663803101, 'eval_matthews_correlation': 0.6306559696899426, 'eval_runtime': 3.4155, 'eval_samples_per_second': 305.37, 'eval_steps_per_second': 4.977, 'epoch': 9.0}
{'loss': 0.0599, 'learning_rate': 1.5149253731343285e-05, 'epoch': 9.7}
04/11/2022 19:07:14 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8750605583190918, 'eval_matthews_correlation': 0.6213387173757855, 'eval_runtime': 3.39, 'eval_samples_per_second': 307.668, 'eval_steps_per_second': 5.015, 'epoch': 10.0}
{'loss': 0.0573, 'learning_rate': 1.4776119402985077e-05, 'epoch': 10.45}
04/11/2022 19:08:48 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.6306357383728027, 'eval_matthews_correlation': 0.6306425398187112, 'eval_runtime': 3.4402, 'eval_samples_per_second': 303.179, 'eval_steps_per_second': 4.942, 'epoch': 11.0}
{'loss': 0.0628, 'learning_rate': 1.4402985074626867e-05, 'epoch': 11.19}
{'loss': 0.0504, 'learning_rate': 1.4029850746268658e-05, 'epoch': 11.94}
04/11/2022 19:10:22 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.859723687171936, 'eval_matthews_correlation': 0.6433364564823282, 'eval_runtime': 3.4784, 'eval_samples_per_second': 299.847, 'eval_steps_per_second': 4.887, 'epoch': 12.0}
{'loss': 0.055, 'learning_rate': 1.365671641791045e-05, 'epoch': 12.69}
04/11/2022 19:11:56 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8361722826957703, 'eval_matthews_correlation': 0.6364215869715157, 'eval_runtime': 3.4777, 'eval_samples_per_second': 299.913, 'eval_steps_per_second': 4.888, 'epoch': 13.0}
{'loss': 0.0443, 'learning_rate': 1.328358208955224e-05, 'epoch': 13.43}
04/11/2022 19:13:30 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1996649503707886, 'eval_matthews_correlation': 0.6181999490554073, 'eval_runtime': 3.4356, 'eval_samples_per_second': 303.583, 'eval_steps_per_second': 4.948, 'epoch': 14.0}
{'loss': 0.0506, 'learning_rate': 1.2910447761194032e-05, 'epoch': 14.18}
{'loss': 0.0434, 'learning_rate': 1.2537313432835823e-05, 'epoch': 14.93}
04/11/2022 19:15:05 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7477784156799316, 'eval_matthews_correlation': 0.644274221106768, 'eval_runtime': 3.4176, 'eval_samples_per_second': 305.181, 'eval_steps_per_second': 4.974, 'epoch': 15.0}
{'loss': 0.032, 'learning_rate': 1.2164179104477613e-05, 'epoch': 15.67}
04/11/2022 19:16:39 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9087778329849243, 'eval_matthews_correlation': 0.6106825188230223, 'eval_runtime': 3.4568, 'eval_samples_per_second': 301.723, 'eval_steps_per_second': 4.918, 'epoch': 16.0}
{'loss': 0.0385, 'learning_rate': 1.1791044776119405e-05, 'epoch': 16.42}
04/11/2022 19:18:13 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9560590386390686, 'eval_matthews_correlation': 0.6207194911624668, 'eval_runtime': 3.4052, 'eval_samples_per_second': 306.299, 'eval_steps_per_second': 4.992, 'epoch': 17.0}
{'loss': 0.0331, 'learning_rate': 1.1417910447761196e-05, 'epoch': 17.16}
{'loss': 0.0272, 'learning_rate': 1.1044776119402986e-05, 'epoch': 17.91}
04/11/2022 19:19:48 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1070849895477295, 'eval_matthews_correlation': 0.6380902412628672, 'eval_runtime': 3.4414, 'eval_samples_per_second': 303.078, 'eval_steps_per_second': 4.94, 'epoch': 18.0}
{'loss': 0.0278, 'learning_rate': 1.0671641791044778e-05, 'epoch': 18.66}
04/11/2022 19:21:22 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7646684646606445, 'eval_matthews_correlation': 0.6528865280950995, 'eval_runtime': 3.4217, 'eval_samples_per_second': 304.824, 'eval_steps_per_second': 4.968, 'epoch': 19.0}
{'loss': 0.0272, 'learning_rate': 1.029850746268657e-05, 'epoch': 19.4}
04/11/2022 19:22:57 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9226912260055542, 'eval_matthews_correlation': 0.66271185211871, 'eval_runtime': 3.505, 'eval_samples_per_second': 297.575, 'eval_steps_per_second': 4.85, 'epoch': 20.0}
{'loss': 0.0227, 'learning_rate': 9.925373134328359e-06, 'epoch': 20.15}
{'loss': 0.0178, 'learning_rate': 9.552238805970149e-06, 'epoch': 20.9}
04/11/2022 19:24:31 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1272459030151367, 'eval_matthews_correlation': 0.6560372356020714, 'eval_runtime': 3.4788, 'eval_samples_per_second': 299.812, 'eval_steps_per_second': 4.887, 'epoch': 21.0}
{'loss': 0.0165, 'learning_rate': 9.17910447761194e-06, 'epoch': 21.64}
04/11/2022 19:26:05 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.0037353038787842, 'eval_matthews_correlation': 0.6577792181478197, 'eval_runtime': 3.4565, 'eval_samples_per_second': 301.754, 'eval_steps_per_second': 4.918, 'epoch': 22.0}
{'loss': 0.0202, 'learning_rate': 8.805970149253732e-06, 'epoch': 22.39}
04/11/2022 19:27:39 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1562016010284424, 'eval_matthews_correlation': 0.6482821804104875, 'eval_runtime': 3.3964, 'eval_samples_per_second': 307.088, 'eval_steps_per_second': 5.005, 'epoch': 23.0}
{'loss': 0.0144, 'learning_rate': 8.432835820895524e-06, 'epoch': 23.13}
{'loss': 0.0127, 'learning_rate': 8.059701492537314e-06, 'epoch': 23.88}
04/11/2022 19:29:14 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.113142967224121, 'eval_matthews_correlation': 0.6749065626668778, 'eval_runtime': 3.4952, 'eval_samples_per_second': 298.412, 'eval_steps_per_second': 4.864, 'epoch': 24.0}
{'loss': 0.0057, 'learning_rate': 7.686567164179105e-06, 'epoch': 24.63}
04/11/2022 19:30:48 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3274942636489868, 'eval_matthews_correlation': 0.6481914570909114, 'eval_runtime': 3.4158, 'eval_samples_per_second': 305.346, 'eval_steps_per_second': 4.977, 'epoch': 25.0}
{'loss': 0.0107, 'learning_rate': 7.313432835820896e-06, 'epoch': 25.37}
04/11/2022 19:32:22 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1148947477340698, 'eval_matthews_correlation': 0.6664065124293871, 'eval_runtime': 3.4008, 'eval_samples_per_second': 306.695, 'eval_steps_per_second': 4.999, 'epoch': 26.0}
{'loss': 0.0143, 'learning_rate': 6.9402985074626876e-06, 'epoch': 26.12}
{'loss': 0.011, 'learning_rate': 6.567164179104478e-06, 'epoch': 26.87}
04/11/2022 19:33:57 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.0970840454101562, 'eval_matthews_correlation': 0.6652097228002016, 'eval_runtime': 3.4313, 'eval_samples_per_second': 303.968, 'eval_steps_per_second': 4.954, 'epoch': 27.0}
{'loss': 0.0129, 'learning_rate': 6.194029850746269e-06, 'epoch': 27.61}
04/11/2022 19:35:31 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.195404291152954, 'eval_matthews_correlation': 0.6748859748065263, 'eval_runtime': 3.4439, 'eval_samples_per_second': 302.854, 'eval_steps_per_second': 4.936, 'epoch': 28.0}
{'loss': 0.0121, 'learning_rate': 5.820895522388061e-06, 'epoch': 28.36}
04/11/2022 19:37:06 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1999742984771729, 'eval_matthews_correlation': 0.6651469200754233, 'eval_runtime': 3.4975, 'eval_samples_per_second': 298.217, 'eval_steps_per_second': 4.861, 'epoch': 29.0}
{'loss': 0.0099, 'learning_rate': 5.447761194029851e-06, 'epoch': 29.1}
{'loss': 0.0098, 'learning_rate': 5.074626865671642e-06, 'epoch': 29.85}
04/11/2022 19:38:40 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.2233766317367554, 'eval_matthews_correlation': 0.6612635767176811, 'eval_runtime': 3.4134, 'eval_samples_per_second': 305.561, 'eval_steps_per_second': 4.98, 'epoch': 30.0}
{'loss': 0.0086, 'learning_rate': 4.701492537313434e-06, 'epoch': 30.6}
04/11/2022 19:40:15 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.309744119644165, 'eval_matthews_correlation': 0.6602295783880692, 'eval_runtime': 3.4015, 'eval_samples_per_second': 306.628, 'eval_steps_per_second': 4.998, 'epoch': 31.0}
{'loss': 0.0045, 'learning_rate': 4.3283582089552236e-06, 'epoch': 31.34}
04/11/2022 19:41:49 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3147814273834229, 'eval_matthews_correlation': 0.6614580779685079, 'eval_runtime': 3.4852, 'eval_samples_per_second': 299.261, 'eval_steps_per_second': 4.878, 'epoch': 32.0}
{'loss': 0.0059, 'learning_rate': 3.955223880597015e-06, 'epoch': 32.09}
{'loss': 0.0093, 'learning_rate': 3.582089552238806e-06, 'epoch': 32.84}
04/11/2022 19:43:23 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.2735002040863037, 'eval_matthews_correlation': 0.6724491783868958, 'eval_runtime': 3.3866, 'eval_samples_per_second': 307.977, 'eval_steps_per_second': 5.02, 'epoch': 33.0}
{'loss': 0.0061, 'learning_rate': 3.208955223880597e-06, 'epoch': 33.58}
04/11/2022 19:44:58 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3526510000228882, 'eval_matthews_correlation': 0.6530734183134956, 'eval_runtime': 3.3942, 'eval_samples_per_second': 307.29, 'eval_steps_per_second': 5.009, 'epoch': 34.0}
{'loss': 0.0116, 'learning_rate': 2.835820895522388e-06, 'epoch': 34.33}
04/11/2022 19:46:32 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3342792987823486, 'eval_matthews_correlation': 0.6724664601338275, 'eval_runtime': 3.4134, 'eval_samples_per_second': 305.563, 'eval_steps_per_second': 4.98, 'epoch': 35.0}
{'loss': 0.0054, 'learning_rate': 2.4626865671641794e-06, 'epoch': 35.07}
{'loss': 0.005, 'learning_rate': 2.08955223880597e-06, 'epoch': 35.82}
04/11/2022 19:48:07 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3558188676834106, 'eval_matthews_correlation': 0.6724664601338275, 'eval_runtime': 3.472, 'eval_samples_per_second': 300.402, 'eval_steps_per_second': 4.896, 'epoch': 36.0}
{'loss': 0.003, 'learning_rate': 1.7164179104477613e-06, 'epoch': 36.57}
04/11/2022 19:49:41 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.334716796875, 'eval_matthews_correlation': 0.6799667905057818, 'eval_runtime': 3.4776, 'eval_samples_per_second': 299.922, 'eval_steps_per_second': 4.888, 'epoch': 37.0}
{'loss': 0.007, 'learning_rate': 1.3432835820895524e-06, 'epoch': 37.31}
04/11/2022 19:51:16 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.355425477027893, 'eval_matthews_correlation': 0.6724664601338275, 'eval_runtime': 3.4194, 'eval_samples_per_second': 305.027, 'eval_steps_per_second': 4.972, 'epoch': 38.0}
{'loss': 0.0047, 'learning_rate': 9.701492537313434e-07, 'epoch': 38.06}
{'loss': 0.005, 'learning_rate': 5.970149253731343e-07, 'epoch': 38.81}
04/11/2022 19:52:50 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3383923768997192, 'eval_matthews_correlation': 0.6701797985979863, 'eval_runtime': 3.4234, 'eval_samples_per_second': 304.668, 'eval_steps_per_second': 4.966, 'epoch': 39.0}
{'loss': 0.006, 'learning_rate': 2.2388059701492537e-07, 'epoch': 39.55}
04/11/2022 19:54:24 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.3383538722991943, 'eval_matthews_correlation': 0.6677282266080609, 'eval_runtime': 3.4465, 'eval_samples_per_second': 302.63, 'eval_steps_per_second': 4.933, 'epoch': 40.0}
{'train_runtime': 3783.7756, 'train_samples_per_second': 90.396, 'train_steps_per_second': 1.417, 'train_loss': 0.06563675348966647, 'epoch': 40.0}
***** train metrics *****
  epoch                    =       40.0
  train_loss               =     0.0656
  train_runtime            = 1:03:03.77
  train_samples            =       8551
  train_samples_per_second =     90.396
  train_steps_per_second   =      1.417
04/11/2022 19:54:44 - INFO - __main__ - *** Evaluate ***
04/11/2022 19:54:47 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
***** eval metrics *****
  epoch                     =       40.0
  eval_loss                 =     0.3985
  eval_matthews_correlation =     0.6233
  eval_runtime              = 0:00:03.46
  eval_samples              =       1043
  eval_samples_per_second   =    301.319
  eval_steps_per_second     =      4.911
04/11/2022 19:54:52 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 4distributed training: False, 16-bits training: False
04/11/2022 19:54:52 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=4,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=None,
evaluation_strategy=IntervalStrategy.NO,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=output/CoLA/SqueezeBERT/runs/Apr11_19-54-52_n31,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=40.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=output/CoLA/SqueezeBERT/,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=output/CoLA/SqueezeBERT/,
save_on_each_node=False,
save_steps=500,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/11/2022 19:54:53 - INFO - datasets.info - Loading Dataset Infos from /home/kangchen/.cache/huggingface/modules/datasets_modules/datasets/glue/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 19:54:53 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/11/2022 19:54:53 - INFO - datasets.info - Loading Dataset info from /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 19:54:53 - WARNING - datasets.builder - Reusing dataset glue (/home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad)
04/11/2022 19:54:53 - INFO - datasets.info - Loading Dataset info from /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 19:54:58 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-1db08f42c472545e.arrow
04/11/2022 19:54:59 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-91155cf05b82b9ff.arrow
04/11/2022 19:54:59 - INFO - datasets.arrow_dataset - Caching processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-4147a859aced43ee.arrow
04/11/2022 19:54:59 - INFO - __main__ - Sample 1824 of the training set: {'sentence': 'I acknowledged that my father, he was tight as an owl.', 'label': 0, 'idx': 1824, 'input_ids': [101, 1045, 8969, 2008, 2026, 2269, 1010, 2002, 2001, 4389, 2004, 2019, 13547, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 19:54:59 - INFO - __main__ - Sample 409 of the training set: {'sentence': 'For him to do that would be a mistake.', 'label': 1, 'idx': 409, 'input_ids': [101, 2005, 2032, 2000, 2079, 2008, 2052, 2022, 1037, 6707, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 19:54:59 - INFO - __main__ - Sample 4506 of the training set: {'sentence': 'Mary sang a song, but Lee never did.', 'label': 1, 'idx': 4506, 'input_ids': [101, 2984, 6369, 1037, 2299, 1010, 2021, 3389, 2196, 2106, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
{'loss': 0.5879, 'learning_rate': 1.9626865671641793e-05, 'epoch': 0.75}
04/11/2022 19:55:42 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.5465927124023438, 'eval_matthews_correlation': 0.3541277636191758, 'eval_runtime': 1.4677, 'eval_samples_per_second': 710.646, 'eval_steps_per_second': 11.583, 'epoch': 1.0}
{'loss': 0.512, 'learning_rate': 1.9253731343283585e-05, 'epoch': 1.49}
04/11/2022 19:56:14 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.5160189270973206, 'eval_matthews_correlation': 0.391243912243602, 'eval_runtime': 1.4572, 'eval_samples_per_second': 715.749, 'eval_steps_per_second': 11.666, 'epoch': 2.0}
{'loss': 0.4867, 'learning_rate': 1.8880597014925376e-05, 'epoch': 2.24}
{'loss': 0.4345, 'learning_rate': 1.8507462686567165e-05, 'epoch': 2.99}
04/11/2022 19:56:45 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.5598610043525696, 'eval_matthews_correlation': 0.4035662082408423, 'eval_runtime': 1.5298, 'eval_samples_per_second': 681.79, 'eval_steps_per_second': 11.113, 'epoch': 3.0}
{'loss': 0.3865, 'learning_rate': 1.8134328358208956e-05, 'epoch': 3.73}
04/11/2022 19:57:16 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.5586897134780884, 'eval_matthews_correlation': 0.41219033031975905, 'eval_runtime': 1.4713, 'eval_samples_per_second': 708.886, 'eval_steps_per_second': 11.554, 'epoch': 4.0}
{'loss': 0.3749, 'learning_rate': 1.7761194029850748e-05, 'epoch': 4.48}
04/11/2022 19:57:48 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.5604987144470215, 'eval_matthews_correlation': 0.4414558823469975, 'eval_runtime': 1.4986, 'eval_samples_per_second': 695.967, 'eval_steps_per_second': 11.344, 'epoch': 5.0}
{'loss': 0.3358, 'learning_rate': 1.738805970149254e-05, 'epoch': 5.22}
{'loss': 0.3145, 'learning_rate': 1.701492537313433e-05, 'epoch': 5.97}
04/11/2022 19:58:19 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.5758951902389526, 'eval_matthews_correlation': 0.45250562782676435, 'eval_runtime': 1.4798, 'eval_samples_per_second': 704.84, 'eval_steps_per_second': 11.488, 'epoch': 6.0}
{'loss': 0.2809, 'learning_rate': 1.6641791044776122e-05, 'epoch': 6.72}
04/11/2022 19:58:51 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.64518141746521, 'eval_matthews_correlation': 0.43872148609062206, 'eval_runtime': 1.4611, 'eval_samples_per_second': 713.845, 'eval_steps_per_second': 11.635, 'epoch': 7.0}
{'loss': 0.2549, 'learning_rate': 1.626865671641791e-05, 'epoch': 7.46}
04/11/2022 19:59:22 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7067423462867737, 'eval_matthews_correlation': 0.44123089969348334, 'eval_runtime': 1.4927, 'eval_samples_per_second': 698.726, 'eval_steps_per_second': 11.389, 'epoch': 8.0}
{'loss': 0.2448, 'learning_rate': 1.5895522388059702e-05, 'epoch': 8.21}
{'loss': 0.2237, 'learning_rate': 1.5522388059701494e-05, 'epoch': 8.96}
04/11/2022 19:59:54 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7497497797012329, 'eval_matthews_correlation': 0.4325231818860751, 'eval_runtime': 1.5018, 'eval_samples_per_second': 694.493, 'eval_steps_per_second': 11.32, 'epoch': 9.0}
{'loss': 0.1885, 'learning_rate': 1.5149253731343285e-05, 'epoch': 9.7}
04/11/2022 20:00:25 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7853518128395081, 'eval_matthews_correlation': 0.418546678917899, 'eval_runtime': 1.4935, 'eval_samples_per_second': 698.341, 'eval_steps_per_second': 11.382, 'epoch': 10.0}
{'loss': 0.187, 'learning_rate': 1.4776119402985077e-05, 'epoch': 10.45}
04/11/2022 20:00:57 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7203251719474792, 'eval_matthews_correlation': 0.45418624291790166, 'eval_runtime': 1.4729, 'eval_samples_per_second': 708.142, 'eval_steps_per_second': 11.542, 'epoch': 11.0}
{'loss': 0.1807, 'learning_rate': 1.4402985074626867e-05, 'epoch': 11.19}
{'loss': 0.1663, 'learning_rate': 1.4029850746268658e-05, 'epoch': 11.94}
04/11/2022 20:01:28 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7635721564292908, 'eval_matthews_correlation': 0.4569650899096484, 'eval_runtime': 1.4755, 'eval_samples_per_second': 706.898, 'eval_steps_per_second': 11.522, 'epoch': 12.0}
{'loss': 0.1469, 'learning_rate': 1.365671641791045e-05, 'epoch': 12.69}
04/11/2022 20:01:59 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7350375652313232, 'eval_matthews_correlation': 0.4621927387299967, 'eval_runtime': 1.4732, 'eval_samples_per_second': 707.987, 'eval_steps_per_second': 11.54, 'epoch': 13.0}
{'loss': 0.1402, 'learning_rate': 1.328358208955224e-05, 'epoch': 13.43}
04/11/2022 20:02:31 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8503610491752625, 'eval_matthews_correlation': 0.4723822195692763, 'eval_runtime': 1.4779, 'eval_samples_per_second': 705.719, 'eval_steps_per_second': 11.503, 'epoch': 14.0}
{'loss': 0.1375, 'learning_rate': 1.2910447761194032e-05, 'epoch': 14.18}
{'loss': 0.1257, 'learning_rate': 1.2537313432835823e-05, 'epoch': 14.93}
04/11/2022 20:03:03 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8547121286392212, 'eval_matthews_correlation': 0.46663910840666245, 'eval_runtime': 1.5153, 'eval_samples_per_second': 688.334, 'eval_steps_per_second': 11.219, 'epoch': 15.0}
{'loss': 0.1238, 'learning_rate': 1.2164179104477613e-05, 'epoch': 15.67}
04/11/2022 20:03:34 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8527681827545166, 'eval_matthews_correlation': 0.4432754043589553, 'eval_runtime': 1.5029, 'eval_samples_per_second': 694.002, 'eval_steps_per_second': 11.312, 'epoch': 16.0}
{'loss': 0.107, 'learning_rate': 1.1791044776119405e-05, 'epoch': 16.42}
04/11/2022 20:04:06 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8599889874458313, 'eval_matthews_correlation': 0.4476395359582461, 'eval_runtime': 1.4765, 'eval_samples_per_second': 706.381, 'eval_steps_per_second': 11.513, 'epoch': 17.0}
{'loss': 0.1081, 'learning_rate': 1.1417910447761196e-05, 'epoch': 17.16}
{'loss': 0.0955, 'learning_rate': 1.1044776119402986e-05, 'epoch': 17.91}
04/11/2022 20:04:37 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9680520296096802, 'eval_matthews_correlation': 0.43577816963420296, 'eval_runtime': 1.4871, 'eval_samples_per_second': 701.387, 'eval_steps_per_second': 11.432, 'epoch': 18.0}
{'loss': 0.0869, 'learning_rate': 1.0671641791044778e-05, 'epoch': 18.66}
04/11/2022 20:05:09 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9208531379699707, 'eval_matthews_correlation': 0.46133824119384026, 'eval_runtime': 1.4784, 'eval_samples_per_second': 705.496, 'eval_steps_per_second': 11.499, 'epoch': 19.0}
{'loss': 0.0884, 'learning_rate': 1.029850746268657e-05, 'epoch': 19.4}
04/11/2022 20:05:40 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9818646311759949, 'eval_matthews_correlation': 0.44963336671994786, 'eval_runtime': 1.4806, 'eval_samples_per_second': 704.432, 'eval_steps_per_second': 11.482, 'epoch': 20.0}
{'loss': 0.0918, 'learning_rate': 9.925373134328359e-06, 'epoch': 20.15}
{'loss': 0.0746, 'learning_rate': 9.552238805970149e-06, 'epoch': 20.9}
04/11/2022 20:06:12 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.0164180994033813, 'eval_matthews_correlation': 0.45284040101677564, 'eval_runtime': 1.528, 'eval_samples_per_second': 682.571, 'eval_steps_per_second': 11.125, 'epoch': 21.0}
{'loss': 0.0802, 'learning_rate': 9.17910447761194e-06, 'epoch': 21.64}
04/11/2022 20:06:44 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.009800910949707, 'eval_matthews_correlation': 0.4611631351812362, 'eval_runtime': 1.4633, 'eval_samples_per_second': 712.778, 'eval_steps_per_second': 11.618, 'epoch': 22.0}
{'loss': 0.0779, 'learning_rate': 8.805970149253732e-06, 'epoch': 22.39}
04/11/2022 20:07:15 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9762973189353943, 'eval_matthews_correlation': 0.4491534084057902, 'eval_runtime': 1.4819, 'eval_samples_per_second': 703.821, 'eval_steps_per_second': 11.472, 'epoch': 23.0}
{'loss': 0.0759, 'learning_rate': 8.432835820895524e-06, 'epoch': 23.13}
{'loss': 0.074, 'learning_rate': 8.059701492537314e-06, 'epoch': 23.88}
04/11/2022 20:07:47 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.0423524379730225, 'eval_matthews_correlation': 0.4481287541235995, 'eval_runtime': 1.5107, 'eval_samples_per_second': 690.424, 'eval_steps_per_second': 11.253, 'epoch': 24.0}
{'loss': 0.0656, 'learning_rate': 7.686567164179105e-06, 'epoch': 24.63}
04/11/2022 20:08:18 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.0601081848144531, 'eval_matthews_correlation': 0.46411094322127294, 'eval_runtime': 1.5334, 'eval_samples_per_second': 680.204, 'eval_steps_per_second': 11.087, 'epoch': 25.0}
{'loss': 0.0601, 'learning_rate': 7.313432835820896e-06, 'epoch': 25.37}
04/11/2022 20:08:50 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.0722028017044067, 'eval_matthews_correlation': 0.458136114916564, 'eval_runtime': 1.4783, 'eval_samples_per_second': 705.537, 'eval_steps_per_second': 11.5, 'epoch': 26.0}
{'loss': 0.0682, 'learning_rate': 6.9402985074626876e-06, 'epoch': 26.12}
{'loss': 0.0567, 'learning_rate': 6.567164179104478e-06, 'epoch': 26.87}
04/11/2022 20:09:21 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.0895177125930786, 'eval_matthews_correlation': 0.4535057217805826, 'eval_runtime': 1.5016, 'eval_samples_per_second': 694.583, 'eval_steps_per_second': 11.321, 'epoch': 27.0}
{'loss': 0.0618, 'learning_rate': 6.194029850746269e-06, 'epoch': 27.61}
04/11/2022 20:09:53 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1051597595214844, 'eval_matthews_correlation': 0.4609982129120627, 'eval_runtime': 1.5168, 'eval_samples_per_second': 687.638, 'eval_steps_per_second': 11.208, 'epoch': 28.0}
{'loss': 0.0567, 'learning_rate': 5.820895522388061e-06, 'epoch': 28.36}
04/11/2022 20:10:24 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1610803604125977, 'eval_matthews_correlation': 0.4637046622918281, 'eval_runtime': 1.4891, 'eval_samples_per_second': 700.401, 'eval_steps_per_second': 11.416, 'epoch': 29.0}
{'loss': 0.0516, 'learning_rate': 5.447761194029851e-06, 'epoch': 29.1}
{'loss': 0.0512, 'learning_rate': 5.074626865671642e-06, 'epoch': 29.85}
04/11/2022 20:10:55 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.172687292098999, 'eval_matthews_correlation': 0.4587117762521935, 'eval_runtime': 1.5269, 'eval_samples_per_second': 683.077, 'eval_steps_per_second': 11.134, 'epoch': 30.0}
{'loss': 0.0429, 'learning_rate': 4.701492537313434e-06, 'epoch': 30.6}
04/11/2022 20:11:27 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.2129753828048706, 'eval_matthews_correlation': 0.4610923588834867, 'eval_runtime': 1.4994, 'eval_samples_per_second': 695.588, 'eval_steps_per_second': 11.337, 'epoch': 31.0}
{'loss': 0.0385, 'learning_rate': 4.3283582089552236e-06, 'epoch': 31.34}
04/11/2022 20:11:59 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.1907886266708374, 'eval_matthews_correlation': 0.4539429381148277, 'eval_runtime': 1.4901, 'eval_samples_per_second': 699.955, 'eval_steps_per_second': 11.409, 'epoch': 32.0}
{'loss': 0.0559, 'learning_rate': 3.955223880597015e-06, 'epoch': 32.09}
{'loss': 0.05, 'learning_rate': 3.582089552238806e-06, 'epoch': 32.84}
04/11/2022 20:12:30 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.216099739074707, 'eval_matthews_correlation': 0.4557726198308099, 'eval_runtime': 1.4801, 'eval_samples_per_second': 704.659, 'eval_steps_per_second': 11.485, 'epoch': 33.0}
{'loss': 0.0391, 'learning_rate': 3.208955223880597e-06, 'epoch': 33.58}
04/11/2022 20:13:01 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.2256988286972046, 'eval_matthews_correlation': 0.4697814803242376, 'eval_runtime': 1.4943, 'eval_samples_per_second': 697.974, 'eval_steps_per_second': 11.376, 'epoch': 34.0}
{'loss': 0.0447, 'learning_rate': 2.835820895522388e-06, 'epoch': 34.33}
04/11/2022 20:13:33 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.263034701347351, 'eval_matthews_correlation': 0.4556358612682346, 'eval_runtime': 1.5244, 'eval_samples_per_second': 684.214, 'eval_steps_per_second': 11.152, 'epoch': 35.0}
{'loss': 0.0449, 'learning_rate': 2.4626865671641794e-06, 'epoch': 35.07}
{'loss': 0.0378, 'learning_rate': 2.08955223880597e-06, 'epoch': 35.82}
04/11/2022 20:14:05 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.2497183084487915, 'eval_matthews_correlation': 0.4610923588834867, 'eval_runtime': 1.4783, 'eval_samples_per_second': 705.558, 'eval_steps_per_second': 11.5, 'epoch': 36.0}
{'loss': 0.0408, 'learning_rate': 1.7164179104477613e-06, 'epoch': 36.57}
04/11/2022 20:14:36 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.2718530893325806, 'eval_matthews_correlation': 0.4637046622918281, 'eval_runtime': 1.4919, 'eval_samples_per_second': 699.097, 'eval_steps_per_second': 11.395, 'epoch': 37.0}
{'loss': 0.0464, 'learning_rate': 1.3432835820895524e-06, 'epoch': 37.31}
04/11/2022 20:15:08 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.27571439743042, 'eval_matthews_correlation': 0.46654885649873884, 'eval_runtime': 1.4768, 'eval_samples_per_second': 706.25, 'eval_steps_per_second': 11.511, 'epoch': 38.0}
{'loss': 0.0405, 'learning_rate': 9.701492537313434e-07, 'epoch': 38.06}
{'loss': 0.0384, 'learning_rate': 5.970149253731343e-07, 'epoch': 38.81}
04/11/2022 20:15:39 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.272375226020813, 'eval_matthews_correlation': 0.46654885649873884, 'eval_runtime': 1.4813, 'eval_samples_per_second': 704.133, 'eval_steps_per_second': 11.477, 'epoch': 39.0}
{'loss': 0.0366, 'learning_rate': 2.2388059701492537e-07, 'epoch': 39.55}
04/11/2022 20:16:11 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.2754487991333008, 'eval_matthews_correlation': 0.46654885649873884, 'eval_runtime': 1.4908, 'eval_samples_per_second': 699.624, 'eval_steps_per_second': 11.403, 'epoch': 40.0}
{'train_runtime': 1270.571, 'train_samples_per_second': 269.202, 'train_steps_per_second': 4.219, 'train_loss': 0.14637622735393582, 'epoch': 40.0}
***** train metrics *****
  epoch                    =       40.0
  train_loss               =     0.1464
  train_runtime            = 0:21:10.57
  train_samples            =       8551
  train_samples_per_second =    269.202
  train_steps_per_second   =      4.219
04/11/2022 20:16:14 - INFO - __main__ - *** Evaluate ***
04/11/2022 20:16:16 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
***** eval metrics *****
  epoch                     =       40.0
  eval_loss                 =      0.516
  eval_matthews_correlation =     0.3912
  eval_runtime              = 0:00:01.58
  eval_samples              =       1043
  eval_samples_per_second   =    659.668
  eval_steps_per_second     =     10.752
04/11/2022 20:16:20 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 4distributed training: False, 16-bits training: False
04/11/2022 20:16:20 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=4,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=None,
evaluation_strategy=IntervalStrategy.NO,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=output/CoLA/DeBERTa/runs/Apr11_20-16-20_n31,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=40.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=output/CoLA/DeBERTa/,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=output/CoLA/DeBERTa/,
save_on_each_node=False,
save_steps=500,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/11/2022 20:16:21 - INFO - datasets.info - Loading Dataset Infos from /home/kangchen/.cache/huggingface/modules/datasets_modules/datasets/glue/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 20:16:21 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/11/2022 20:16:21 - INFO - datasets.info - Loading Dataset info from /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 20:16:21 - WARNING - datasets.builder - Reusing dataset glue (/home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad)
04/11/2022 20:16:21 - INFO - datasets.info - Loading Dataset info from /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad
04/11/2022 20:16:35 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-3c6224be0f2fa4c0.arrow
04/11/2022 20:16:36 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-3e656a77b168aec2.arrow
04/11/2022 20:16:36 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/kangchen/.cache/huggingface/datasets/glue/cola/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad/cache-7171d009a5164d17.arrow
04/11/2022 20:16:36 - INFO - __main__ - Sample 1824 of the training set: {'sentence': 'I acknowledged that my father, he was tight as an owl.', 'label': 0, 'idx': 1824, 'input_ids': [1, 273, 7981, 272, 312, 1503, 261, 313, 284, 3793, 283, 299, 21010, 260, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 20:16:36 - INFO - __main__ - Sample 409 of the training set: {'sentence': 'For him to do that would be a mistake.', 'label': 1, 'idx': 409, 'input_ids': [1, 434, 417, 264, 333, 272, 338, 282, 266, 4273, 260, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/11/2022 20:16:36 - INFO - __main__ - Sample 4506 of the training set: {'sentence': 'Mary sang a song, but Lee never did.', 'label': 1, 'idx': 4506, 'input_ids': [1, 2612, 10850, 266, 1710, 261, 304, 2967, 518, 464, 260, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
{'loss': 0.4056, 'learning_rate': 1.9626865671641793e-05, 'epoch': 0.75}
04/11/2022 20:18:46 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.3221299946308136, 'eval_matthews_correlation': 0.6549479450779031, 'eval_runtime': 5.9693, 'eval_samples_per_second': 174.727, 'eval_steps_per_second': 2.848, 'epoch': 1.0}
{'loss': 0.2353, 'learning_rate': 1.9253731343283585e-05, 'epoch': 1.49}
04/11/2022 20:20:56 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.3016906976699829, 'eval_matthews_correlation': 0.7217043723814445, 'eval_runtime': 5.9388, 'eval_samples_per_second': 175.624, 'eval_steps_per_second': 2.863, 'epoch': 2.0}
{'loss': 0.1713, 'learning_rate': 1.8880597014925376e-05, 'epoch': 2.24}
{'loss': 0.1361, 'learning_rate': 1.8507462686567165e-05, 'epoch': 2.99}
04/11/2022 20:23:07 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.38514888286590576, 'eval_matthews_correlation': 0.7020058815866403, 'eval_runtime': 5.9195, 'eval_samples_per_second': 176.196, 'eval_steps_per_second': 2.872, 'epoch': 3.0}
{'loss': 0.0924, 'learning_rate': 1.8134328358208956e-05, 'epoch': 3.73}
04/11/2022 20:25:16 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.37066903710365295, 'eval_matthews_correlation': 0.7053018852426886, 'eval_runtime': 6.0071, 'eval_samples_per_second': 173.628, 'eval_steps_per_second': 2.83, 'epoch': 4.0}
{'loss': 0.0777, 'learning_rate': 1.7761194029850748e-05, 'epoch': 4.48}
04/11/2022 20:27:27 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.40710437297821045, 'eval_matthews_correlation': 0.7151270999416698, 'eval_runtime': 6.0446, 'eval_samples_per_second': 172.551, 'eval_steps_per_second': 2.812, 'epoch': 5.0}
{'loss': 0.0686, 'learning_rate': 1.738805970149254e-05, 'epoch': 5.22}
{'loss': 0.0572, 'learning_rate': 1.701492537313433e-05, 'epoch': 5.97}
04/11/2022 20:29:37 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.5084410905838013, 'eval_matthews_correlation': 0.7191367667883292, 'eval_runtime': 5.9415, 'eval_samples_per_second': 175.545, 'eval_steps_per_second': 2.861, 'epoch': 6.0}
{'loss': 0.0449, 'learning_rate': 1.6641791044776122e-05, 'epoch': 6.72}
04/11/2022 20:31:47 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.6618549227714539, 'eval_matthews_correlation': 0.7017811661601455, 'eval_runtime': 5.9062, 'eval_samples_per_second': 176.593, 'eval_steps_per_second': 2.878, 'epoch': 7.0}
{'loss': 0.0327, 'learning_rate': 1.626865671641791e-05, 'epoch': 7.46}
04/11/2022 20:33:57 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.5987206101417542, 'eval_matthews_correlation': 0.7073440068301372, 'eval_runtime': 5.8965, 'eval_samples_per_second': 176.884, 'eval_steps_per_second': 2.883, 'epoch': 8.0}
{'loss': 0.034, 'learning_rate': 1.5895522388059702e-05, 'epoch': 8.21}
{'loss': 0.0266, 'learning_rate': 1.5522388059701494e-05, 'epoch': 8.96}
04/11/2022 20:36:08 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.6214457750320435, 'eval_matthews_correlation': 0.7179862082640477, 'eval_runtime': 6.0158, 'eval_samples_per_second': 173.378, 'eval_steps_per_second': 2.826, 'epoch': 9.0}
{'loss': 0.0232, 'learning_rate': 1.5149253731343285e-05, 'epoch': 9.7}
04/11/2022 20:38:18 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.6961842775344849, 'eval_matthews_correlation': 0.7160832752554566, 'eval_runtime': 6.0093, 'eval_samples_per_second': 173.564, 'eval_steps_per_second': 2.829, 'epoch': 10.0}
{'loss': 0.0193, 'learning_rate': 1.4776119402985077e-05, 'epoch': 10.45}
04/11/2022 20:40:29 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.6730976104736328, 'eval_matthews_correlation': 0.7318682894567475, 'eval_runtime': 6.072, 'eval_samples_per_second': 171.773, 'eval_steps_per_second': 2.8, 'epoch': 11.0}
{'loss': 0.0228, 'learning_rate': 1.4402985074626867e-05, 'epoch': 11.19}
{'loss': 0.0167, 'learning_rate': 1.4029850746268658e-05, 'epoch': 11.94}
04/11/2022 20:42:39 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8361548185348511, 'eval_matthews_correlation': 0.7064619982506548, 'eval_runtime': 6.0287, 'eval_samples_per_second': 173.007, 'eval_steps_per_second': 2.82, 'epoch': 12.0}
{'loss': 0.0088, 'learning_rate': 1.365671641791045e-05, 'epoch': 12.69}
04/11/2022 20:44:49 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7547518610954285, 'eval_matthews_correlation': 0.7118672334071823, 'eval_runtime': 5.971, 'eval_samples_per_second': 174.678, 'eval_steps_per_second': 2.847, 'epoch': 13.0}
{'loss': 0.0208, 'learning_rate': 1.328358208955224e-05, 'epoch': 13.43}
04/11/2022 20:46:59 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7852212190628052, 'eval_matthews_correlation': 0.7244348119408112, 'eval_runtime': 6.0157, 'eval_samples_per_second': 173.38, 'eval_steps_per_second': 2.826, 'epoch': 14.0}
{'loss': 0.0103, 'learning_rate': 1.2910447761194032e-05, 'epoch': 14.18}
{'loss': 0.0101, 'learning_rate': 1.2537313432835823e-05, 'epoch': 14.93}
04/11/2022 20:49:09 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9205960631370544, 'eval_matthews_correlation': 0.7071679193414487, 'eval_runtime': 5.9857, 'eval_samples_per_second': 174.248, 'eval_steps_per_second': 2.84, 'epoch': 15.0}
{'loss': 0.0091, 'learning_rate': 1.2164179104477613e-05, 'epoch': 15.67}
04/11/2022 20:51:20 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8899788856506348, 'eval_matthews_correlation': 0.7152958743717809, 'eval_runtime': 5.9628, 'eval_samples_per_second': 174.919, 'eval_steps_per_second': 2.851, 'epoch': 16.0}
{'loss': 0.011, 'learning_rate': 1.1791044776119405e-05, 'epoch': 16.42}
04/11/2022 20:53:30 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8995300531387329, 'eval_matthews_correlation': 0.7065367325489877, 'eval_runtime': 6.0081, 'eval_samples_per_second': 173.6, 'eval_steps_per_second': 2.83, 'epoch': 17.0}
{'loss': 0.0115, 'learning_rate': 1.1417910447761196e-05, 'epoch': 17.16}
{'loss': 0.0109, 'learning_rate': 1.1044776119402986e-05, 'epoch': 17.91}
04/11/2022 20:55:41 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.824478030204773, 'eval_matthews_correlation': 0.7188269016570265, 'eval_runtime': 5.9799, 'eval_samples_per_second': 174.417, 'eval_steps_per_second': 2.843, 'epoch': 18.0}
{'loss': 0.0066, 'learning_rate': 1.0671641791044778e-05, 'epoch': 18.66}
04/11/2022 20:57:51 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8376995921134949, 'eval_matthews_correlation': 0.7048397713428748, 'eval_runtime': 5.9327, 'eval_samples_per_second': 175.804, 'eval_steps_per_second': 2.865, 'epoch': 19.0}
{'loss': 0.0136, 'learning_rate': 1.029850746268657e-05, 'epoch': 19.4}
04/11/2022 21:00:02 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.7228776216506958, 'eval_matthews_correlation': 0.7180556621539342, 'eval_runtime': 5.9159, 'eval_samples_per_second': 176.304, 'eval_steps_per_second': 2.874, 'epoch': 20.0}
{'loss': 0.0184, 'learning_rate': 9.925373134328359e-06, 'epoch': 20.15}
{'loss': 0.0112, 'learning_rate': 9.552238805970149e-06, 'epoch': 20.9}
04/11/2022 21:02:12 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8339197635650635, 'eval_matthews_correlation': 0.7124197511303331, 'eval_runtime': 5.8774, 'eval_samples_per_second': 177.459, 'eval_steps_per_second': 2.892, 'epoch': 21.0}
{'loss': 0.008, 'learning_rate': 9.17910447761194e-06, 'epoch': 21.64}
04/11/2022 21:04:22 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8335080146789551, 'eval_matthews_correlation': 0.7170793617749411, 'eval_runtime': 5.9116, 'eval_samples_per_second': 176.433, 'eval_steps_per_second': 2.876, 'epoch': 22.0}
{'loss': 0.0062, 'learning_rate': 8.805970149253732e-06, 'epoch': 22.39}
04/11/2022 21:06:33 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.8701121211051941, 'eval_matthews_correlation': 0.7222581894519668, 'eval_runtime': 5.9753, 'eval_samples_per_second': 174.551, 'eval_steps_per_second': 2.845, 'epoch': 23.0}
{'loss': 0.0036, 'learning_rate': 8.432835820895524e-06, 'epoch': 23.13}
{'loss': 0.0055, 'learning_rate': 8.059701492537314e-06, 'epoch': 23.88}
04/11/2022 21:08:43 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9553564786911011, 'eval_matthews_correlation': 0.7103003691457358, 'eval_runtime': 5.9265, 'eval_samples_per_second': 175.989, 'eval_steps_per_second': 2.868, 'epoch': 24.0}
{'loss': 0.0052, 'learning_rate': 7.686567164179105e-06, 'epoch': 24.63}
04/11/2022 21:10:53 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 1.031861662864685, 'eval_matthews_correlation': 0.7066289614158936, 'eval_runtime': 5.9133, 'eval_samples_per_second': 176.382, 'eval_steps_per_second': 2.875, 'epoch': 25.0}
{'loss': 0.0044, 'learning_rate': 7.313432835820896e-06, 'epoch': 25.37}
04/11/2022 21:13:04 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.908524215221405, 'eval_matthews_correlation': 0.7166829458787656, 'eval_runtime': 5.9157, 'eval_samples_per_second': 176.309, 'eval_steps_per_second': 2.874, 'epoch': 26.0}
{'loss': 0.0077, 'learning_rate': 6.9402985074626876e-06, 'epoch': 26.12}
{'loss': 0.0031, 'learning_rate': 6.567164179104478e-06, 'epoch': 26.87}
04/11/2022 21:15:14 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9540871381759644, 'eval_matthews_correlation': 0.7065606765499661, 'eval_runtime': 5.9059, 'eval_samples_per_second': 176.602, 'eval_steps_per_second': 2.878, 'epoch': 27.0}
{'loss': 0.0061, 'learning_rate': 6.194029850746269e-06, 'epoch': 27.61}
04/11/2022 21:17:25 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9490128755569458, 'eval_matthews_correlation': 0.7166829458787656, 'eval_runtime': 5.9275, 'eval_samples_per_second': 175.958, 'eval_steps_per_second': 2.868, 'epoch': 28.0}
{'loss': 0.0044, 'learning_rate': 5.820895522388061e-06, 'epoch': 28.36}
04/11/2022 21:19:35 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9832736849784851, 'eval_matthews_correlation': 0.7114703739146411, 'eval_runtime': 6.0033, 'eval_samples_per_second': 173.737, 'eval_steps_per_second': 2.832, 'epoch': 29.0}
{'loss': 0.0042, 'learning_rate': 5.447761194029851e-06, 'epoch': 29.1}
{'loss': 0.0039, 'learning_rate': 5.074626865671642e-06, 'epoch': 29.85}
04/11/2022 21:21:45 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9595434665679932, 'eval_matthews_correlation': 0.7196514911730956, 'eval_runtime': 5.9605, 'eval_samples_per_second': 174.985, 'eval_steps_per_second': 2.852, 'epoch': 30.0}
{'loss': 0.0044, 'learning_rate': 4.701492537313434e-06, 'epoch': 30.6}
04/11/2022 21:23:56 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9742899537086487, 'eval_matthews_correlation': 0.7199380227790022, 'eval_runtime': 5.9377, 'eval_samples_per_second': 175.658, 'eval_steps_per_second': 2.863, 'epoch': 31.0}
{'loss': 0.0035, 'learning_rate': 4.3283582089552236e-06, 'epoch': 31.34}
04/11/2022 21:26:07 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9880340695381165, 'eval_matthews_correlation': 0.7082072781752784, 'eval_runtime': 5.9849, 'eval_samples_per_second': 174.272, 'eval_steps_per_second': 2.84, 'epoch': 32.0}
{'loss': 0.0032, 'learning_rate': 3.955223880597015e-06, 'epoch': 32.09}
{'loss': 0.004, 'learning_rate': 3.582089552238806e-06, 'epoch': 32.84}
04/11/2022 21:28:17 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9493471384048462, 'eval_matthews_correlation': 0.7291167683143954, 'eval_runtime': 6.0666, 'eval_samples_per_second': 171.925, 'eval_steps_per_second': 2.802, 'epoch': 33.0}
{'loss': 0.0041, 'learning_rate': 3.208955223880597e-06, 'epoch': 33.58}
04/11/2022 21:30:28 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9633450508117676, 'eval_matthews_correlation': 0.7201529718902805, 'eval_runtime': 5.9612, 'eval_samples_per_second': 174.965, 'eval_steps_per_second': 2.852, 'epoch': 34.0}
{'loss': 0.0031, 'learning_rate': 2.835820895522388e-06, 'epoch': 34.33}
04/11/2022 21:32:38 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9470292329788208, 'eval_matthews_correlation': 0.707494702982884, 'eval_runtime': 6.0244, 'eval_samples_per_second': 173.129, 'eval_steps_per_second': 2.822, 'epoch': 35.0}
{'loss': 0.0047, 'learning_rate': 2.4626865671641794e-06, 'epoch': 35.07}
{'loss': 0.0026, 'learning_rate': 2.08955223880597e-06, 'epoch': 35.82}
04/11/2022 21:34:49 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9455040693283081, 'eval_matthews_correlation': 0.7126473563379142, 'eval_runtime': 5.9386, 'eval_samples_per_second': 175.63, 'eval_steps_per_second': 2.863, 'epoch': 36.0}
{'loss': 0.0044, 'learning_rate': 1.7164179104477613e-06, 'epoch': 36.57}
04/11/2022 21:36:59 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9667984843254089, 'eval_matthews_correlation': 0.7185317402386888, 'eval_runtime': 6.0143, 'eval_samples_per_second': 173.419, 'eval_steps_per_second': 2.827, 'epoch': 37.0}
{'loss': 0.0038, 'learning_rate': 1.3432835820895524e-06, 'epoch': 37.31}
04/11/2022 21:39:09 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9663541316986084, 'eval_matthews_correlation': 0.7158056856218383, 'eval_runtime': 5.9338, 'eval_samples_per_second': 175.774, 'eval_steps_per_second': 2.865, 'epoch': 38.0}
{'loss': 0.006, 'learning_rate': 9.701492537313434e-07, 'epoch': 38.06}
{'loss': 0.0037, 'learning_rate': 5.970149253731343e-07, 'epoch': 38.81}
04/11/2022 21:41:20 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9884665012359619, 'eval_matthews_correlation': 0.712854430350736, 'eval_runtime': 6.0449, 'eval_samples_per_second': 172.542, 'eval_steps_per_second': 2.812, 'epoch': 39.0}
{'loss': 0.0025, 'learning_rate': 2.2388059701492537e-07, 'epoch': 39.55}
04/11/2022 21:43:30 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
{'eval_loss': 0.9841368198394775, 'eval_matthews_correlation': 0.7133588478664811, 'eval_runtime': 5.9699, 'eval_samples_per_second': 174.709, 'eval_steps_per_second': 2.848, 'epoch': 40.0}
{'train_runtime': 5227.2364, 'train_samples_per_second': 65.434, 'train_steps_per_second': 1.025, 'train_loss': 0.032114223465879464, 'epoch': 40.0}
***** train metrics *****
  epoch                    =       40.0
  train_loss               =     0.0321
  train_runtime            = 1:27:07.23
  train_samples            =       8551
  train_samples_per_second =     65.434
  train_steps_per_second   =      1.025
04/11/2022 21:43:54 - INFO - __main__ - *** Evaluate ***
04/11/2022 21:44:00 - INFO - datasets.metric - Removing /home/kangchen/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
***** eval metrics *****
  epoch                     =       40.0
  eval_loss                 =     0.3017
  eval_matthews_correlation =     0.7217
  eval_runtime              = 0:00:06.00
  eval_samples              =       1043
  eval_samples_per_second   =    173.666
  eval_steps_per_second     =      2.831
